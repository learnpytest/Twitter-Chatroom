(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1db76844"],{1280:function(t,e,a){"use strict";a("df7a")},"3af2":function(t,e,a){"use strict";a("aa2e")},"8b63":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tweets-wrapper"},t._l(t.tweets,(function(e,n){return s("div",{key:n,staticClass:"tweet",on:{click:function(a){return a.stopPropagation(),a.preventDefault(),function(){return t.$router.push({name:"reply-list",params:{id:e.TweetId}})}.apply(null,arguments)}}},[s("div",{staticClass:"user-pic",on:{click:function(a){return a.stopPropagation(),a.preventDefault(),function(){return t.$router.push({name:"user",params:{id:e.User.id}})}.apply(null,arguments)}}},[s("img",{attrs:{src:t._f("emptyImage")(e.User.avatar),alt:""}})]),s("div",{staticClass:"tweet-info"},[s("div",{staticClass:"info"},[s("p",{staticClass:"user-name"},[t._v(" "+t._s(e.User.name)+" "),s("span",{staticClass:"user-id"},[t._v("@"+t._s(e.User.account)+" • ")]),s("span",{staticClass:"time"},[t._v(t._s(t._f("fromNow")(e.createdAt)))])])]),s("div",{staticClass:"tweet-text"},[t._v(t._s(e.description))]),s("div",{staticClass:"tweet-buttons-control"},[s("div",{staticClass:"tweet-buttons"},[s("img",{attrs:{src:a("5482"),alt:""},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.handleShowModalClick(e.TweetId)}}}),s("p",{staticClass:"reply-num"},[t._v(t._s(e.RepliesCount))])]),s("div",{staticClass:"tweet-buttons"},[e.isLiked?s("img",{attrs:{id:"liked-btn",src:a("c92c"),alt:""},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.unLike(e.TweetId)}}}):s("img",{attrs:{src:a("5ead"),alt:""},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.addLike(e.TweetId)}}}),s("p",{staticClass:"liked-num",class:{liked:e.isLiked}},[t._v(" "+t._s(e.LikesCount)+" ")])])])])])})),0)},n=[],r=a("5530"),i=a("1da1"),o=a("2909"),l=(a("96cf"),a("d81d"),a("a9e3"),a("60e2")),c=a("ac0d"),u={mixins:[c["a"],c["b"]],props:{initialTweets:{type:Array,required:!0},initialShowReplyModal:{type:Boolean}},data:function(){return{showReplyModal:!1,tweets:[]}},watch:{initialTweets:function(t){this.tweets=Object(o["a"])(t)}},created:function(){this.fetchData()},methods:{fetchData:function(){this.showReplyModal=this.initialShowReplyModal,this.tweets=this.initialTweets},addLike:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,l["a"].postLike(t);case 3:if(s=a.sent,n=s.data,"success"===n.status){a.next=7;break}throw new Error(n.message);case 7:e.tweets=e.tweets.map((function(e){return e.TweetId===Number(t)?Object(r["a"])(Object(r["a"])({},e),{},{isLiked:!0,LikesCount:e.LikesCount+1}):Object(r["a"])({},e)})),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](0),console.log("error",a.t0);case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))()},unLike:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,l["a"].deleteLike(t);case 3:if(s=a.sent,n=s.data,"success"===n.status){a.next=7;break}throw new Error(n.message);case 7:e.tweets=e.tweets.map((function(e){return e.TweetId===Number(t)?Object(r["a"])(Object(r["a"])({},e),{},{isLiked:!1,LikesCount:e.LikesCount-1}):Object(r["a"])({},e)})),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](0),console.log("error",a.t0);case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))()},handleShowModalClick:function(t){this.showReplyModal=!0,this.$emit("show-reply-modal",t)}}},d=u,w=(a("aa85"),a("2877")),p=Object(w["a"])(d,s,n,!1,null,"2e98bd68",null);e["a"]=p.exports},"99f4":function(t,e,a){},aa2e:function(t,e,a){},aa85:function(t,e,a){"use strict";a("99f4")},d81d:function(t,e,a){"use strict";var s=a("23e7"),n=a("b727").map,r=a("1dde"),i=r("map");s({target:"Array",proto:!0,forced:!i},{map:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},df7a:function(t,e,a){},f255:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isProcessing?t._e():a("div",{staticClass:"container"},[t.showModal?a("div",{staticClass:"new-tweet-modal"},[a("NewTweetModal",{attrs:{initialShowModal:t.showModal},on:{"show-modal":t.modalToggle,updateData:t.updateTweetsData}})],1):t._e(),t.showReplyModal?a("div",{staticClass:"new-tweet-modal"},[a("ReplyTweetModal",{attrs:{initialShowReplyModal:t.showReplyModal,initialTweetId:t.replyTweetId},on:{"show-reply-modal":t.replyModalToggle}})],1):t._e(),a("div",{staticClass:"usermain"},[a("div",{staticClass:"sidebar"},[a("Sidebar",{attrs:{initialShowModal:t.showModal},on:{"show-modal":t.modalToggle}})],1),a("div",{staticClass:"main"},[a("div",{staticClass:"addtweet"},[a("AddTweet",{attrs:{initialShowModal:t.showModal},on:{"show-modal":t.modalToggle}})],1),a("div",{staticClass:"tweets"},[a("Tweets",{attrs:{initialShowReplyModal:t.showReplyModal,initialTweets:t.userTweets},on:{"show-reply-modal":t.replyModalToggle}})],1)]),a("div",{staticClass:"popular"},[a("Popular")],1)])])},n=[],r=a("5530"),i=a("2909"),o=a("1da1"),l=(a("96cf"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"addtweet-wrapper"},[a("div",{staticClass:"header"},[t._v("首頁")]),a("div",{staticClass:"text-box"},[a("div",{staticClass:"user-info"},[a("img",{staticClass:"user-pic",attrs:{src:t._f("emptyImage")(t.currentUser.avatar),alt:""}})]),a("div",{staticClass:"text-area",on:{click:t.handleShowModalClick}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"form-control",attrs:{rows:"3",placeholder:"有什麽新鮮事"},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}})])]),t._m(0)])}),c=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tweet-btn"},[a("button",[t._v("推文")])])}],u=a("ac0d"),d=a("5fad"),w={mixins:[u["a"]],props:{initialShowModal:{type:Boolean,required:!0}},data:function(){return{showModal:"",text:"",currentUser:{}}},created:function(){this.fetchData(),this.getCurrentUser()},methods:{fetchData:function(){this.showModal=this.initialShowModal},handleShowModalClick:function(){this.showModal=!1,this.$emit("show-modal")},getCurrentUser:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d["a"].getCurrentUser();case 3:if(a=e.sent,s=a.data,n=a.statusText,"OK"===n){e.next=7;break}throw new Error(n);case 7:t.currentUser=s,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()}}},p=w,h=(a("1280"),a("2877")),f=Object(h["a"])(p,l,c,!1,null,"5277a3a8",null),m=f.exports,v=a("8b63"),g=a("9a31"),b=a("c4cd"),k=a("8624"),C=a("0162"),M=a("2f62"),T=a("6ad5"),y=a("6783"),x={components:{AddTweet:m,Tweets:v["a"],Popular:g["a"],Sidebar:b["a"],NewTweetModal:k["a"],ReplyTweetModal:C["a"]},data:function(){return{showModal:!1,showReplyModal:!1,userTweets:[],replyTweetId:""}},created:function(){this.getTweets()},methods:{updateTweetsData:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getTweets();case 2:case"end":return e.stop()}}),e)})))()},modalToggle:function(){this.showModal?this.showModal=!1:this.showModal=!0},getTweets:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y["a"].getAllTweet();case 3:a=e.sent,s=a.data,t.userTweets=Object(i["a"])(s),t.showModal=!1,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},replyModalToggle:function(t){this.showReplyModal?(this.replyTweetId="",this.showReplyModal=!1):(this.replyTweetId=t,this.showReplyModal=!0)}},computed:Object(r["a"])({},Object(M["c"])({isProcessing:T["o"]})),watch:{isProcessing:"getTweets"}},_=x,R=(a("3af2"),Object(h["a"])(_,s,n,!1,null,"07cbd6e0",null));e["default"]=R.exports}}]);
//# sourceMappingURL=chunk-1db76844.17247064.js.map