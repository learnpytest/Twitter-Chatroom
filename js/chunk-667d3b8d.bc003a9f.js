(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-667d3b8d"],{"214b":function(t,e,s){t.exports=s.p+"img/icon_close.883c7712.svg"},2892:function(t,e,s){"use strict";s("b0a2")},"321a":function(t,e,s){},"661a":function(t,e,s){},8624:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("form",{staticClass:"new-tweet-modal",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleTweetSubmit.apply(null,arguments)}}},[a("div",{staticClass:"new-text-box"},[a("div",{staticClass:"close-btn"},[a("button",[a("img",{attrs:{src:s("214b"),alt:""},on:{click:t.handleShowModalClick}})])]),a("div",{staticClass:"text-box"},[a("div",{staticClass:"user-info"},[a("img",{staticClass:"user-pic",attrs:{src:t._f("emptyImage")(t.currentUserPic),alt:""}})]),a("div",{staticClass:"text-area"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"form-control",attrs:{rows:"3",maxlength:"141",placeholder:"有什麽新鮮事？"},domProps:{value:t.text},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.resetEmpty.apply(null,arguments)},input:function(e){e.target.composing||(t.text=e.target.value)}}}),a("span",{staticClass:"limiter"},[t._v(t._s(t.charactersLeft))])])]),a("div",{staticClass:"tweet-btn"},[t.text.length>=140?a("p",[t._v("字數不可超過 140 字")]):t._e(),t.submitEmptyField?a("p",[t._v("內容不可空白")]):t._e(),a("button",[t._v("推文")])])])])},r=[],n=s("5530"),i=s("1da1"),c=(s("96cf"),s("2f62")),o=s("6ad5"),l=s("ac0d"),u=s("5fad"),d=s("6783"),m={mixins:[l["a"]],props:{initialShowModal:{type:Boolean,required:!0}},data:function(){return{showModal:"",limit:-1,text:"",currentUserId:"",submitEmptyField:!1,currentUserPic:{}}},created:function(){this.fetchData(),this.fetchCurrentUser()},methods:{fetchData:function(){this.showModal=this.initialShowModal},fetchCurrentUser:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s,a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u["a"].getCurrentUser();case 3:s=e.sent,a=s.data,r=a.avatar,n=a.id,t.currentUserId=n,t.currentUserPic=r,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),console.log("error",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},handleShowModalClick:function(){this.showModal?(this.showModal=!1,this.$emit("show-modal")):(this.showModal=!0,this.$emit("show-modal"))},handleTweetSubmit:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.text.length){e.next=3;break}return t.submitEmptyField=!0,e.abrupt("return");case 3:if(!(t.text.length>140)){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,d["a"].postOneUserTweet({description:t.text});case 8:if(s=e.sent,a=s.data,"success"===a.status){e.next=12;break}throw new Error(a.message);case 12:t.$emit("updateData"),e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](5),console.log("error",e.t0);case 18:case"end":return e.stop()}}),e,null,[[5,15]])})))()},resetEmpty:function(){this.submitEmptyField=!1}},computed:Object(n["a"])({charactersLeft:function(){var t=this.text.length,e=140;return e-t+" / "+e+"剩餘字數"}},Object(c["c"])({getCurrentUser:o["k"]}))},p=m,h=(s("2892"),s("2877")),f=Object(h["a"])(p,a,r,!1,null,"7ee6236e",null);e["a"]=f.exports},"984a":function(t,e,s){"use strict";s("661a")},"9dd4":function(t,e,s){t.exports=s.p+"img/Logo_small.21c0a93a.svg"},a357:function(t,e,s){t.exports=s.p+"img/icon_chat.6e17a436.svg"},b0a2:function(t,e,s){},b6e6:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE0AAABRCAYAAACXHStQAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAWDSURBVHgB7ZxbctMwFIaPXAgz5aXsIOyAJdAdwAoIAwXeaFfQZAWUNy5l0q6AsoLCCugO6iX0lUJrzlHsVkolWTfbspN/JpM0sh33z2fp1yVmIKjYgffAYBdfXuDzGfyBGTuCHNaSxKoXxRvYx6fpUnmOjyO4hI9o3gWsxZUJr58pysdARo7gN1I4gbW4RNO2DNuNkck50ni+Nk80rYAfFtuvzQOxTnuHhlzDObgpx31eskP4CSskJv6BBB3h0wtwVYGm/UXzVqSllU3zo0082tEqxBS2/IY3bfJRB23eXdNCaZOPPkjzsuU32Cf8B5m2Yr9AQ/cALE0osIWljIfBuZjwzDcIZcp3r2Cm2X4L99hiX+AxvqZtcqgX5T8KyKdDiSlMV1C8hVMk5ami6AK7VY+pW1VeyhN8bx/sleNxZ+wrrzt7qUxbYqJtxDv1/FJG6qZ4FCLvGOzU+4DMTIU2tEnbL8ibglvr2zvyMmOpBW2iSvImXuTtYJ33WvkFJSdWt4ErbdK+O/AEDfyg2V93RsnHlKx2C0faROEld8Y+wzYe4zm4xZRz/LLmqcaUWtJIIbRJx6GKn/GWdgy2SpC8etJIAbSJosqeZ7wCXoIreQkFZCvSSCba0IhH4CEP8nJ8kPEz6FD2plHLlqFxykIcFvKMDEJAppgyttyt05hibRrJQFtedq281aeM52ZaQ7RJh+mBeU6mkZqkTfocX/NaGH53N60F2qRDknkFzJ0CMsAJRqG9pmKKs2kkLW04V4CmbUMDKr+sOSSQ8fxMe4UTyxvwXVl4DdtNXh4pBGQv00g0tAOqE2+QNuljOjTP37TFSc+VhQ3TpjgP54CMdd6xr3neppG6pm3pXKbQUkC263vqVGi6Mwyetj02Vo4gb+M5fbTcxXsEOYg0Ukq03Xx0wwE53LTXOMpBA40qtVi3qeRt3hVmvG+Y9TQKN22Cw0P3kTamWKrVIW3SafiYZ1ifEmwaP/6iElZP43VMmyhez27geQYOv8cxrQe0iQrNeFFM4ydiog2a6QNG0BjcdRDPNBNtA1NYThPEJ1eYdUbqtaKZxlWsxkrIuKYxp4UwvVU008quyBiGLkwD9yCWmKHlzNKKHPCP9zv3qY9svQ+FXepmHUYyzUgZfdCnNOo63sKP0KzMfoIbFPMOsXoE6k575MkWX5VmvccvcNc6EhV8qcWeqgMfTFodZdChJLNoCYUNIkUZnR5iiD1Qr1FpbmioY8r4rwpdySKzNvVmVQoiLUXKpH5lJLKW1cxwdweU8REM1xaROuHMvaHyJq0czh6rC9ujzMssig8b2CJ6tur+l+diXEqlvI01Fd5mlVkLAuRlGj9h3UBew5TxhX33ceqwA7Mq+ZHWAWXcrAf8cycOu53Rz5Jijxw7m9Y2ZVLWKqzH6vIml165k9YSZUHBdNM+PvjIyTR+iTRMWVMpPqbcSHugpwynu04gUG0E0xiyNq2kbKIpPg652YnX2rOCmzVt06xK9qSZKMs8V3a3mOJjysq0Wsoc/4Eug2kM2ZEWiTI0/wkG0w99NatSrWk1lJ3YUOYVTBM0q1I9aXrKaFrGOM+ZYjCNIaNpRsqwQtZRFpC1ZjikdACJy0yaiTJ2N8z2IZjGkNY0V8r4Xf4WN60brFmV9KRZUua8bKnHZlVSmmZDmXcwzdKZB/WVmjQTZdfwi+5s4Jy1aA7xC45vDUB3b9BElI0i3aAp4awVorukmSiz1UDNqiTfdC6cspW43aFM2ojHBh8ln+Jj6sa08vYNz5z2bml4OTXdkjZy+DHWALJWiMTLs56yFTerkmiaeRSCgukmZq0VNquSuOb2WLPNCd3ai33GVnFtGNctaZc4JDPiddriR1cDz1pRVezCFj1gLa3+AyTL4pC03Wx9AAAAAElFTkSuQmCC"},b71b:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[t.showModal?s("div",{staticClass:"new-tweet-modal"},[s("NewTweetModal",{attrs:{initialShowModal:t.showModal},on:{"show-modal":t.modalToggle}})],1):t._e(),s("div",{staticClass:"public-chat-modal"}),s("div",{staticClass:"public-chat"},[s("div",{staticClass:"sidebar"},[s("Sidebar",{attrs:{initialShowModal:t.showModal},on:{"show-modal":t.modalToggle}})],1),s("div",{staticClass:"online-users"},[s("div",{staticClass:"header"},[s("div",{staticClass:"header-info"},[s("p",[t._v("上線使用者 ("+t._s(t.allUsers.length)+")")])])]),s("div",{staticClass:"active-users"},t._l(t.allUsers,(function(e){return s("div",{key:e.id,staticClass:"active-user"},[s("img",{attrs:{src:e.avatar,alt:""}}),s("p",{staticClass:"user-name"},[t._v(t._s(e.name))]),s("p",{staticClass:"user-id"},[t._v("@"+t._s(e.account))])])})),0)]),s("div",{staticClass:"chat-room"},[s("ChatRoom")],1)])])},r=[],n=s("1da1"),i=s("5530"),c=(s("96cf"),s("b0c0"),s("c4cd")),o=s("8624"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"chat-room-wrapper"},[t._m(0),a("div",{attrs:{id:"chat-wrapper"}},[t._l(t.allMessages,(function(e,r){return a("div",{key:r,staticClass:"chat-wrapper"},[1===e.type?a("div",{staticClass:"online-box center"},[a("span",{staticClass:"online-text"},[t._v(t._s(e.name)+" 上線")])]):t._e(),-1===e.type?a("div",{staticClass:"online-box center"},[a("span",{staticClass:"online-text"},[t._v(t._s(e.name)+" 下線")])]):t._e(),e.message&&e.name!==t.currentUser.name?a("div",{staticClass:"reply-box"},[a("div",{staticClass:"reply-text-info bottom-align"},[a("img",{staticClass:"user-pic",attrs:{src:s("f6e3"),alt:""}}),a("div",{staticClass:"reply-text-time"},[a("div",{staticClass:"reply-text"},[t._v(t._s(e.message))])])])]):t._e(),e.message&&e.name===t.currentUser.name?a("div",{staticClass:"sent-box right"},[a("div",{staticClass:"sent-text"},[t._v(t._s(e.message))])]):t._e()])})),a("div",{staticClass:"chat-wrapper"},[a("div",{staticClass:"online-box center"},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.typing,expression:"typing"}],staticClass:"online-text"},[t._v("正在輸入訊息...")])])])],2),a("div",{staticClass:"chat-field"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.temp.message,expression:"temp.message"}],attrs:{type:"text",id:"sendtxt",placeholder:"輸入訊息..."},domProps:{value:t.temp.message},on:{input:function(e){e.target.composing||t.$set(t.temp,"message",e.target.value)}}}),a("button",{staticClass:"sendBtn",on:{click:t.sendMessage}},[a("img",{attrs:{src:s("b6e6")}})])])])},u=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"header"},[s("div",{staticClass:"header-info"},[s("p",[t._v("公開聊天室")])])])}],d=s("56d7"),m=s("2f62"),p=s("5fad"),h={name:"ChatRooom",sockets:{users:function(t){this.users=t},typing:function(){this.typing=!0},stopTyping:function(){this.typing=!1}},data:function(){return{ready:!1,typing:!1,messages:[],userName:[],temp:{message:"",name:""},isNewuserComeIn:!1,currentUser:{}}},methods:{sendMessage:function(){this.temp.name=this.currentUser.name,d["default"].emit("message",{id:this.currentUser.id,name:this.temp.name,message:this.temp.message,type:0}),this.temp.message="",this.temp.name=""},fetchCurrentUser:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var s,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p["a"].getCurrentUser();case 3:if(s=e.sent,a=s.data,r=s.statusText,"OK"===r){e.next=7;break}throw new Error(r);case 7:t.currentUser=Object(i["a"])({},a),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()}},created:function(){this.fetchCurrentUser()},computed:Object(i["a"])({},Object(m["d"])({allMessages:"allMessages",allUsers:"allUsers"})),watch:{temp:{handler:function(t){t.message?d["default"].emit("typing"):d["default"].emit("stopTyping")},deep:!0}}},f=h,v=(s("984a"),s("2877")),g=Object(v["a"])(f,l,u,!1,null,"f6f44b32",null),C=g.exports,w={components:{Sidebar:c["a"],NewTweetModal:o["a"],ChatRoom:C},beforeRouteLeave:function(t,e,s){d["default"].emit("leaved",this.currentUser),s()},sockets:{connect:function(){console.log("socket connected")},disconnect:function(){console.log("socket disconnected!")},allMessages:function(t){console.log("publichroom.js allMessages",t)},Created:function(t){console.log("publichroom.js Created",t)},joined:function(t){console.log("publicroom",t)},newUserReady:function(t){console.log("publicroom newUserReady",t),this.$store.state.newUserReady=Object(i["a"])({},t)}},data:function(){return{showModal:!1,showReplyModal:!1,userName:"Louis",currentUser:{}}},created:function(){var t=this;window.onbeforeunload=function(){d["default"].emit("leaved",t.currentUser)},this.fetchCurrentUser(),d["default"].emit("Created","StartPublicChatroom")},computed:Object(i["a"])({},Object(m["d"])({allUsers:"allUsers"})),methods:{newUser:function(){d["default"].emit("user",Object(i["a"])({},this.currentUser)),d["default"].emit("joined",{id:this.currentUser.id,name:this.currentUser.name,message:0,type:1})},fetchCurrentUser:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var s,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p["a"].getCurrentUser();case 3:if(s=e.sent,a=s.data,r=s.statusText,"OK"===r){e.next=7;break}throw new Error(r);case 7:t.currentUser=Object(i["a"])({},a),t.newUser(),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()},modalToggle:function(){this.showModal?this.showModal=!1:this.showModal=!0},replyModalToggle:function(t){this.showReplyModal?(this.replyTweetId="",this.showReplyModal=!1):(this.replyTweetId=t,this.showReplyModal=!0)},clickButton:function(t){this.$socket.emit("emit_method",t)}}},b=w,x=(s("d5df"),Object(v["a"])(b,a,r,!1,null,"7517641c",null));e["default"]=x.exports},bf0d:function(t,e,s){t.exports=s.p+"img/icon_cog.2ff65de4.svg"},c4cd:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sidebar-wrapper"},[a("ul",{staticClass:"nav-links"},[a("li",[a("router-link",{attrs:{to:"#"}},[a("img",{staticClass:"logo",attrs:{src:s("9dd4"),alt:""}})])],1),a("li",[a("router-link",{attrs:{to:{name:"UserMain"}}},[a("div",{staticClass:"nav-link"},[a("img",{staticClass:"filter-orange",attrs:{src:s("dffc"),alt:""}}),a("p",{staticClass:"nav-link_text"},[t._v("首頁")])])])],1),a("li",[a("router-link",{attrs:{to:{name:"user",params:{id:t.currentUserId}}}},[a("div",{staticClass:"nav-link"},[a("img",{staticClass:"filter-orange",attrs:{src:s("8f36"),alt:""}}),a("p",{staticClass:"nav-link_text"},[t._v("個人資料")])])])],1),a("li",[a("router-link",{attrs:{to:{name:"public-room"}}},[a("div",{staticClass:"nav-link"},[a("img",{staticClass:"filter-orange",attrs:{src:s("a357"),alt:""}}),a("p",{staticClass:"nav-link_text"},[t._v("公開聊天室")])])])],1),a("li",[a("router-link",{attrs:{to:{name:"user-setting"}}},[a("div",{staticClass:"nav-link"},[a("img",{staticClass:"filter-orange",attrs:{src:s("bf0d"),alt:""}}),a("p",{staticClass:"nav-link_text"},[t._v("設定")])])])],1),a("li",{staticClass:"nav-link"},[a("button",{on:{click:t.handleShowModalClick}},[t._v("推文")])])]),a("div",{staticClass:"logout",on:{click:t.logout}},[a("router-link",{attrs:{to:"#"}},[a("div",{staticClass:"nav-link"},[a("img",{staticClass:"filter-orange",attrs:{src:s("f667"),alt:""}}),a("p",{staticClass:"nav-link_text"},[t._v("登出")])])])],1)])},r=[],n=s("1da1"),i=s("5530"),c=(s("96cf"),s("2f62")),o=s("6ad5"),l=s("5fad"),u={name:"Sidebar",props:{initialShowModal:{type:Boolean,required:!0}},data:function(){return{showModal:"",currentUserId:""}},created:function(){this.getCurrentUser()},methods:Object(i["a"])(Object(i["a"])({},Object(c["b"])({revokeAuthentication:o["H"]})),{},{logout:function(){this.revokeAuthentication(),this.$router.push("/login")},handleShowModalClick:function(){this.showModal=!0,this.$emit("show-modal")},getCurrentUser:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var s,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["a"].getCurrentUser();case 3:if(s=e.sent,a=s.data,r=s.statusText,"OK"===r){e.next=7;break}throw new Error(r);case 7:t.currentUserId=a.id,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()}})},d=u,m=(s("c9ce"),s("2877")),p=Object(m["a"])(d,a,r,!1,null,"23a5645b",null);e["a"]=p.exports},c9ce:function(t,e,s){"use strict";s("cc13")},cc13:function(t,e,s){},d5df:function(t,e,s){"use strict";s("321a")},f6e3:function(t,e,s){t.exports=s.p+"img/Photo_user2.a33359fb.png"}}]);
//# sourceMappingURL=chunk-667d3b8d.bc003a9f.js.map